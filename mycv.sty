\usepackage[T1]{fontenc}

\usepackage{fontawesome}
\usepackage{hyperref}
\setlength{\parindent}{0cm}
\usepackage{paracol}
\usepackage{ifthen}

\usepackage{tikz}
\usepackage{tikz-3dplot}
\usepackage{smartdiagram}
\usepackage{float}
\usepackage{amsmath}

\usepackage{array}
%\setlength\extrarowheight{1.5em} % adds some spacing between the lines of the CV's tabulars
% not used here as not to interfer with other tables
\usetikzlibrary{decorations.text}
\usetikzlibrary{fadings}
\usetikzlibrary{calc}

\usetikzlibrary{shapes.misc,positioning}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{backgrounds}
\usetikzlibrary{shadings}
\usetikzlibrary{calendar}
\usetikzlibrary{er}
\usetikzlibrary{patterns} % horizontal lines, vertical lines, north east lines, north west lines, grid, crosshatch, dots, crosshatch dots, fivepointed stars, sixpointed stars, bricks
\usetikzlibrary{shapes}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{decorations}
\usetikzlibrary{topaths}

\usepackage{graphicx}
%\usepackage[usenames, dvipsnames]{color}
% https://de.sharelatex.com/learn/Using_colours_in_LaTeX#!#Reference_guide z.B. \color{RubineRed}
%\usepackage{xcolor}


% avoid line overflow
\setlength{\emergencystretch}{2pt}

% Improved line spacing and typography
\linespread{1.15} % Slightly increased line spacing for better readability
\setlength{\parskip}{0.35em} % Better paragraph spacing

% Optimize itemize spacing for better readability
\usepackage{enumitem}
\setlist[itemize]{topsep=0.3em, partopsep=0em, itemsep=0.15em, parsep=0em, leftmargin=1.2em}
%---------------------------------------------------------------------------------

\usepackage{titlesec} % Allows creating custom \sections

% Format of the section titles
\titleformat{\section}{
\scshape\Large\raggedright}{}{0em}{}[\color{titlerulecolour}{\titlerule[1.5pt]}] % smallcaps, Large, continuous line - looks better if two columns, might look a bit too dramatic if just one ;)
\titlespacing{\section}{0pt}{16pt}{12pt} % Spacing around titles {<left spacing>}{<before spacing>}{<after spacing>} - increased for better hierarchy
%----------------------------------------------------

 \newcommand{\cvkeyword}[3]{
 \colorbox{#2}{\textcolor{#3}{#1}} \phantom{}%
 }

%------------------------
\newcommand{\cvtag}[1]{% from alta-cv: https://www.overleaf.com/latex/templates/altacv-template/trgqjpwnmtgv
  \tikz[baseline]\node[draw=black!40,rounded corners,inner sep=0.4em]{\color{black!50}#1};
}


%------------------------------------------------------------------------ ICON Cross

\newcommand{\iconcross}[7]{%
\begin{tikzpicture}%
\draw[ultra thick,draw=#2] (-2,-2) -- (2,2);%
\draw[ultra thick, draw=#2] (-2,2) -- (2,-2);%
\node[above=0.5em,text=#3] at (0,1) {#1 #4};%
\node[below=0.5em,text=#3] at (0,-1) {#1 #5};%
\node[right=0.5em,text=#3] at (1,0) {#1 #6};%
\node[left=0.5em,text=#3] at (-1,0) {#1 #7};%
\end{tikzpicture}%
}


\usepackage{smartdiagram}
%-----------------------------------------------------
% set smartdiagram colours, from: https://github.com/Johayon/Data-Scientist-Resume-LaTeX/blob/master/twentysecondcv.cls


%-------------------------------------------------------
\smartdiagramset{
    bubble center node font = \footnotesize,
    bubble node font = \footnotesize,
    % specifies the minimum size of the bubble center node
    bubble center node size = 0.5cm,
    %  specifies the minimum size of the bubbles
    bubble node size = 0.5cm,
    % specifies which is the distance among the bubble center node and the other bubbles
    distance center/other bubbles = 0.3cm,
    % sets the distance from the text to the border of the bubble center node
    distance text center bubble = 0.5cm,
    % set center bubble color
    bubble center node color = pblue,
    % define the list of colors usable in the diagram
    set color list = {materialcyan, orange, green, materialorange, materialteal, materialamber, materialindigo, materialgreen, materiallime},
    % sets the opacity at which the bubbles are shown
    bubble fill opacity = 0.6,
    % sets the opacity at which the bubble text is shown
    bubble text opacity = 1,
    description title text width=0.5cm,
    description title width=0.5cm,
    description width=5cm,
    description text width=5cm,
    descriptive items y sep =1.25,
    back arrow distance = 0,
    back arrow disabled = true,
    border color = white
}
%-------------------------------------------------------------------------------- Dummy text

\newcommand{\lorem}{Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec a diam lectus.} % Dummy text

%------------------------------------------------------------------------------- pictures
\newcommand{\roundpic}[1]{\begin{figure}[H]\tikz  \draw [path picture={ \node at (path picture bounding box.center){\includegraphics[height=3.5cm]{#1}} ;}] (0,2) circle (1.7) ;\end{figure}}

\newcommand{\squarepic}[1]{\begin{figure}[H]\tikz  \draw [path picture={ \node at (path picture bounding box.center){\includegraphics[height=4cm]{#1}} ;}] (0,0) - - (-2,2) - - (0,4) - - (2,2) - - cycle ;\end{figure}}


%----------------------------------------------------------------------------- pictoFraction

\newcommand{\icon}[3]{%
\ifats
    % ATS mode - remove decorative icons from footer
    \phantom{x}\phantom{x}%
\else
    % Regular mode - show icons
    \phantom{x}{#3\color{#2}#1}\phantom{x}%
\fi
}

%------------------------------------------------------------------ pictogram Fraction: pictoFraction

\newcommand{\pictofraction}[6]{%
\pgfmathparse{#3 - 1}\foreach \n in {0,...,\pgfmathresult}{\icon{#1}{#2}{#6}}%
\pgfmathparse{#5 - 1}\foreach \n in {0,...,\pgfmathresult}{\icon{#1}{#4}{#6}}%
}

%----------------------------------------------------- font highlighting / boxes with background color

\newcommand{\bg}[3]{%
\ifats
    % ATS mode - simple bold text without background colors
    \textbf{#3}%
\else
    % Regular mode - colored background boxes
    \colorbox{#1}{\bfseries\color{#2}#3}%
\fi
}
\newcommand{\bgupper}[3]{%
\ifats
    % ATS mode - simple uppercase bold text
    \textbf{\MakeUppercase{#3}}%
\else
    % Regular mode - colored background with large font
    \colorbox{#1}{\color{#2}\huge\bfseries\MakeUppercase{#3}}%
\fi
}

%----------------------------------------------------------------------------- Bubble Diagram

\newcommand{\bubblediagram}[1]{\smartdiagram[bubble diagram]{#1}}

\newcommand{\skillbubble}[2]{%
\begin{tikzpicture}%
\draw[draw=none,fill=#1] (0,0) circle (0.#2);%
\end{tikzpicture}%
}

\newcommand{\hobbyicon}[5]{%
\begin{tikzpicture}%
\draw[draw=none,fill=#3] (0,0) circle (0.5);%
\node[](icon) at (0,0) {#4#1};%
\node[below=#5,align=center] at (icon) {#2};%
\end{tikzpicture}
}


%--------------------------------------------------------------------------- rules / separators

\newcommand{\dashrule}[2]{\begin{figure}[H]\begin{minipage}[t]{#1\textwidth}\tikz \draw[loosely dashed,#2] (0pt,0pt) -- (\textwidth,0pt);\end{minipage}\end{figure}}

\newcommand{\dotrule}[2]{\begin{figure}[H]\begin{minipage}[t]{#1\textwidth}\tikz \draw[loosely dotted, ultra thick,#2] (0,0) -- (\textwidth,0);\end{minipage}\end{figure}}


% ----------------------------------------------------------------------------------- ELEMENTS

\newcommand{\event}[5]{%
{%
\draw[draw=black, line width=0.2em,anchor=west] (0,#1) -- (#5,#1);%
\node[fill=#2,right,inner sep=0.5em] 	at (#5,#1) {\textbf{#3}~~#4 };%
} % startpunkt #1. Farbe #2, Detaildatum #3, Beschreibung #4, Entfernung von Timeline #5
}

\newcommand{\barrule}[3]{%
\ifats
    % ATS mode - just show appropriate spacing without bullet
    \hspace{0.5em}\vspace{0.3em}%
\else
    % Regular mode - show skill bars
    \hspace{0.5em}{\color{#3}\rule[\baselineskip]{#1\textwidth}{#2}}\vspace{0.5em}%
\fi
}

\newcommand{\cvevent}[6]{%
    \parbox[t]{1.2cm}{\raggedright #1} % First column with fixed width and text forced to multiple lines
    & \textbf{#2}\vspace{0.4em}\newline\textsc{#3} $\cdot$ {#4 ~\ifats\else\faMapMarker\fi}\newline{\color{black!70}\footnotesize #5}\vspace{1.8em} % Second column - improved spacing
    & \ifats\else\raisebox{-0.7\height}{\includegraphics[height=1cm]{Images/#6}}\fi % Third column - hide image in ATS mode
}

\newcommand{\cveventwide}[6]{%
    \parbox[t]{1.2cm}{\raggedright #1} % First column with fixed width and text forced to multiple lines
    & \textbf{#2}\vspace{0.4em}\newline\textsc{#3} $\cdot$ {#4 ~\ifats\else\faMapMarker\fi}\newline{\color{black!70}\footnotesize #5}\vspace{1.8em} % Second column - improved spacing
    & \ifats\else\raisebox{-0.7\height}{\includegraphics[width=1.5cm]{Images/#6}}\fi % Third column - hide image in ATS mode
}

\newcommand{\cvlinkevent}[7]{%
    \parbox[t]{1.2cm}{\raggedright #1} % First column with fixed width and text forced to multiple lines
    & \textbf{#2}\vspace{0.25em}\newline{#3}\newline\textsc{#4} $\cdot$ {#5 ~\ifats\else\faMapMarker\fi}\newline{\color{black!70}\footnotesize #6}\vspace{1.5em} % Second column
    & \ifats\else\raisebox{-0.7\height}{\includegraphics[height=1cm]{Images/#7}}\fi % Third column - hide image in ATS mode
}

\newcommand{\cvelinkventwide}[7]{%
    \parbox[t]{1.2cm}{\raggedright #1} % First column with fixed width and text forced to multiple lines
    & \textbf{#2}\vspace{0.25em}\newline{#3}\newline\textsc{#4} $\cdot$ {#5 ~\ifats\else\faMapMarker\fi}\newline{\color{black!70}\footnotesize #6}\vspace{1.5em} % Second column
    & \ifats\else\raisebox{-0.7\height}{\includegraphics[width=1.5cm]{Images/#7}}\fi % Third column - hide image in ATS mode
}

\newcommand{\cvdegree}[6]{{#1} & \textbf{#2}\newline\textsc{#3} $\cdot$ {#4 {\phantom{i}\footnotesize ~\faUniversity}}\newline{\color{black!70}\scriptsize #5}\vspace{0.5em} & \raisebox{-0.7\height}{\includegraphics[height=0.5cm]{#6}}}

\newcommand{\cvdegreesm}[6]{{#1} & \textbf{#2}\newline\textsc{#3} $\cdot$ \textsc{#4} {\newline #5 {\phantom{i}\footnotesize ~\ifats\else\faUniversity\fi}}\newline{\color{black!70}\scriptsize #6}\vspace{0.5em}}






% ----------------------------------------------------------------------------------- HEADERS

\newcommand{\simpleheader}[6]{%
\ifats
    % ATS mode - simple text header without graphics
    \begin{center}
    {\Huge #4 \textbf{#5}}\\[0.8em]
    {\normalsize #6}
    \end{center}
    \vspace{-3.0em}%
\else
    % Regular mode - full TikZ header
    \tikz[remember picture,overlay] {%
    % Shift the header position up by adjusting the yshift value
    \node[rectangle, fill=#1, anchor=north, minimum width=\paperwidth, minimum height=4.2cm, yshift=0.6cm] (header) at (current page.north) {};%
    \node[draw=none, align=left] (name) at (header) {%
    {\Huge \color{#2} #4 \textbf{#5} }%
    };%
    \node[draw=none, below, yshift=-0.5cm] (titles) at (name.south) {\color{#2}#6};%
    }\vspace{-0.5cm}%
\fi
}

\newcommand{\descriptiveheader}[7]{%
\ifats
    % ATS mode - simple text header with description
    \begin{center}
    {\Huge #4 \textbf{#5}}\\[0.8em]
    {\normalsize #6}\\[0.3em]
    \rule{0.5\textwidth}{0.5pt}\\[0.3em]
    \end{center}
    \vspace{0.3em}
    % Better formatted description paragraph
    \begin{center}
    \begin{minipage}{0.85\textwidth}
    \normalsize #7
    \end{minipage}
    \end{center}
    \vspace{-3.0em}%
\else
    % Regular mode - full TikZ header with graphics
    \tikz[remember picture,overlay] {%
    % Shift the header position up by adjusting the yshift value
    \node[rectangle, fill=#1, anchor=north, minimum width=\paperwidth, minimum height=11.6cm, yshift=4.2cm] (header) at (current page.north) {};%
    \node[draw=none, align=left] (name) at (header) {%
    {\Huge \color{#2} #4 \textbf{#5} }%
    };%
    \node[draw=none, below, yshift=-0.5cm] (titles) at (name.south) {\color{#2}#6};%
    % Draw the separator
    \draw[thick, #3] ($(titles.south west)+(4.4,-0.4)$) -- ($(titles.south east)+(-4.4,-0.4)$);%
    % Add the description with better text alignment
    \node[draw=none, below, text width=16cm, minimum height=2.5cm, yshift=0cm] (description) at ($(titles.south)+(0,-0.6)$) {\color{#2}#7};%
    \draw[thick, #3] ($(header.south west)+(0,0)$) -- ($(header.south east)+(0,0)$);
    }\vspace{3.0cm}%
\fi
}


% ----------------------------------------------------------------------------------- ICONS

% ORCid symbol
\newcommand{\orcidbubble}[4]{%
\ifats
    % ATS mode - keep ORCID identifier with proper line breaking
    \ifx&#4&%
        % If 4th argument is empty, show ORCID and 3rd
        ORCID: #3%
        \vspace{0.3em}% Consistent spacing with infobubbleicon in ATS mode
    \else
        % If 4th argument is not empty, show with proper line breaks and alignment
        \begin{minipage}[t]{\linewidth}
        ORCID: #3\\
        \phantom{ORCID: }#4%
        \end{minipage}%
        \vspace{0.3em}% Consistent spacing with infobubbleicon in ATS mode
    \fi
\else
    % Regular mode - full visual design
    \scalebox{1.3}{%
    \begin{tikzpicture}
    \draw[#1, fill=#1] (0,0.16) circle (0.2 cm) node[#2] {\fontfamily{qag}\selectfont\tiny iD};
    % Check if the 5th argument is empty
    \ifx&#4&%
        % If 4th argument is empty, place the 3rd as is
        \node[right=0.2cm, align=left] at (0,0.15) {#3};
    \else
        % If 4th argument is not empty, place the 3rd and then the 4th below it
        \node[right=0.2cm, align=left] at (0,0.15) {#3};
        \node[right=0.2cm, align=left] at (0,-0.15) {#4};
    \fi
    \end{tikzpicture}%
    }%
\fi
}

\newcommand{\infobubble}[5]{%
\ifats
    % ATS mode - text only with bullet points on new lines
    \ifx&#5&%
        % If 5th argument is empty, show only 4th with bullet on new line
        \begin{minipage}[t]{\linewidth}
        $\bullet$ #4\\
        \end{minipage}%
        \vspace{0.8em}% Increased spacing between infobubbles in ATS mode
    \else
        % If 5th argument is not empty, show both with bullet on new line
        \begin{minipage}[t]{\linewidth}
        \setlength{\baselineskip}{0.85\baselineskip}% Reduced internal line spacing in ATS mode
        $\bullet$ #4\\[-0.2em]% Reduced spacing between lines within infobubble
        \phantom{$\bullet$ }#5%
        \end{minipage}%
        \vspace{0.8em}% Increased spacing between infobubbles in ATS mode
    \fi
\else
    % Regular mode - full visual design
    \scalebox{1.3}{%
    \begin{tikzpicture}
    \draw[draw=#2,fill=#2] (0,0) circle (0.2cm);
    \node[] at (0,0) {\color{#3}\textbf{#1}};
    % Check if the 5th argument is empty
    \ifx&#5&%
        % If 5th argument is empty, place the 4th as is
        \node[right=0.2cm, align=left] at (0,0) {#4};
    \else
        % If 5th argument is not empty, place the 4th and then the 5th below it
        \node[right=0.2cm, align=left] at (0,0.15) {#4};
        \node[right=0.2cm, align=left] at (0,-0.15) {#5};
    \fi
    \end{tikzpicture}%
    }%
\fi
}

% Specialized infobubble that keeps icons in ATS mode (for socials, publications, websites)
\newcommand{\infobubbleicon}[5]{%
\ifats
    % ATS mode - keep icon but simplify layout with better spacing and alignment
    \ifx&#5&%
        % If 5th argument is empty, show icon and 4th with reduced spacing for left column sections
        #1\hspace{1em}#4%
        \vspace{0.3em}% Reduced spacing for icon sections to avoid double spacing from manual spacing
    \else
        % If 5th argument is not empty, show with proper line breaks and alignment
        \begin{minipage}[t]{\linewidth}
        \setlength{\baselineskip}{0.85\baselineskip}% Reduced internal line spacing in ATS mode
        #1\hspace{1em}#4\\[-0.2em]% Reduced spacing between lines within infobubble
        \phantom{#1\hspace{1em}}#5%
        \end{minipage}%
        \vspace{0.3em}% Reduced spacing for icon sections to avoid double spacing from manual spacing
    \fi
\else
    % Regular mode - full visual design
    \scalebox{1.3}{%
    \begin{tikzpicture}
    \draw[draw=#2,fill=#2] (0,0) circle (0.2cm);
    \node[] at (0,0) {\color{#3}\textbf{#1}};
    % Check if the 5th argument is empty
    \ifx&#5&%
        % If 5th argument is empty, place the 4th as is
        \node[right=0.2cm, align=left] at (0,0) {#4};
    \else
        % If 5th argument is not empty, place the 4th and then the 5th below it
        \node[right=0.2cm, align=left] at (0,0.15) {#4};
        \node[right=0.2cm, align=left] at (0,-0.15) {#5};
    \fi
    \end{tikzpicture}%
    }%
\fi
}

% Programming section helper for ATS mode
\newcommand{\progskill}[1]{%
\ifats
    % ATS mode - simple bulleted list
    $\bullet$ \textbf{#1}%
\else
    % Regular mode - use tabular format (not used directly)
    \textbf{#1}%
\fi
}

% ATS helper command for better section formatting
\newcommand{\atssection}[1]{%
\ifats
    % ATS mode - simple section headers
    \vspace{0.5em}
    \textbf{\MakeUppercase{#1}}
    \vspace{0.3em}
    \hrule
    \vspace{0.3em}%
\else
    % Regular mode - use normal section
    \section*{#1}%
\fi
}

% Page number command that's hidden in ATS mode
\newcommand{\pagenumber}[1]{%
\ifats
    % ATS mode - no page numbers
\else
    % Regular mode - show page numbers
    \section*{Page #1}%
\fi
}

% Page spacing helper for ATS
\newcommand{\pagespacing}{%
\ifats
    % ATS mode - minimal spacing
    \subsection*{}
    \vspace{0.5em}%
\else
    % Regular mode - normal spacing for paracol layout
    \subsection*{}
    \vspace{3.8em}%
\fi
}

% Left column font size helper for ATS
\newcommand{\atsleftcolumnfont}{%
\ifats
    % ATS mode - larger font for better readability
    \small%
\else
    % Regular mode - use footnotesize as originally set
    \footnotesize%
\fi
}

\newcommand{\infobubblesm}[5]{%
\ifats
    % ATS mode - text only with bullet points
    \ifx&#5&%
        % If 5th argument is empty, show only 4th with bullet
        $\bullet$ #4%
    \else
        % If 5th argument is not empty, show both with bullet
        $\bullet$ #4 #5%
    \fi
\else
    % Regular mode - full visual design
    \scalebox{1.0}{%
    \begin{tikzpicture}
    \draw[draw=#2,fill=#2] (0,0) circle (0.2cm);
    \node[] at (0,0) {\color{#3}\textbf{#1}};
    % Check if the 5th argument is empty
    \ifx&#5&%
        % If 5th argument is empty, place the 4th as is
        \node[right=0.2cm, align=left] at (0,0) {#4};
    \else
        % If 5th argument is not empty, place the 4th and then the 5th below it
        \node[right=0.2cm, align=left] at (0,0.15) {#4};
        \node[right=0.2cm, align=left] at (0,-0.15) {#5};
    \fi
    \end{tikzpicture}%
    }%
\fi
}
